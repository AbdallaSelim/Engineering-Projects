#include "BluetoothSerial.h"

BluetoothSerial SerialBT;
int relayPin = 26;

void setup() {
  delay(2000);  // Give USB/Bluetooth time to initialize
  Serial.begin(115200);
  Serial.println("Starting...");

  if (!SerialBT.begin("ESP32_Relay")) {
    Serial.println("Bluetooth start failed!");
    while (true); // Halt execution
  }

  Serial.println("Bluetooth started. Waiting for input...");
  pinMode(relayPin, OUTPUT);
  digitalWrite(relayPin, HIGH);  // Relay OFF initially
}

void loop() {
  if (SerialBT.available()) {
    char cmd = SerialBT.read();
    Serial.printf("Received command: %c\n", cmd);

    if (cmd == '1') {
      Serial.println("Relay ON");
      digitalWrite(relayPin, LOW);
      delay(500);
      digitalWrite(relayPin, HIGH);
      Serial.println("Relay OFF");
    }
  }
}
